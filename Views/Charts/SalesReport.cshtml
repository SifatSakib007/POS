<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>

@{
    ViewData["Title"] = "Sales Report";
}

<div class="p-6 bg-gray-100 min-h-screen flex justify-center items-center">
    <div class="bg-white shadow-2xl rounded-lg max-w-4xl w-full">
        <div class="p-8">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Total Sales and Deposits Per Day</h2>
            <div id="salesChart" style="width: 100%; height: 400px;"></div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        async function fetchSalesAndDepositData() {
            const response = await fetch('/Charts/GetTotalSalesPerDay'); // Confirm this is correct
            const data = await response.json();
            console.log(data);  // Check fetched data in console

            return data;
        }

        async function createChart() {
            const data = await fetchSalesAndDepositData();
            if (!data || data.length === 0) {
                console.error("No data available for chart rendering.");
                return;
            }

            Highcharts.chart('salesChart', {
                chart: { type: 'line' },
                title: { text: 'Total Sales and Deposits Per Day' },
                xAxis: {
                    categories: data.map(item => item.date),
                    title: { text: 'Date' }
                },
                yAxis: {
                    title: { text: 'Amount (৳)' },
                    min: 0
                },
                series: [
                    {
                        name: 'Total Sales',
                        data: data.map(item => item.totalSell),
                        color: '#4CAF50'
                    },
                    {
                        name: 'Total Deposit',
                        data: data.map(item => item.totalDeposit),
                        color: '#FF5733'
                    }
                ]
            });
        }

        document.addEventListener('DOMContentLoaded', createChart);
    </script>

}